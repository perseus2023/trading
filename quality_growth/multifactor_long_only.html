
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>multifactor_long_only</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-11-14"><meta name="DC.source" content="multifactor_long_only.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0 auto;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin-left:300px; margin-right:300px; margin-top:50px; font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:right; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }
h4 { padding:0px; margin:0px 0px 5px; font-family:sans-serif; font-size:0.8em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th {padding:7px 20px; text-align:right; vertical-align:middle; border: 2px solid #d6d4d4; font-weight:bold; align:middle; }
table td {padding:7px 20px; text-align:right; vertical-align:top; border:2px solid #d6d4d4; margin-left:auto;align:middle; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#3">&#31574;&#30053;&#31616;&#20171;</a></li><li><a href="#4">2012&#33267;&#20170;&#25910;&#30410;&#29575;</a></li><li><a href="#5">&#20998;&#24180;&#25910;&#30410;&#29575;</a></li><li><a href="#6">&#20998;&#26376;&#25910;&#30410;&#29575;</a></li><li><a href="#7">&#26368;&#26032;&#25104;&#20221;&#32929;</a></li></ul></div> <h1><center>多因子树量化多头策略</h1></center><h2 id="3">&#31574;&#30053;&#31616;&#20171;</h2>策略依靠因子体系选取未来上涨潜力较大股票：</html>
<html><br> <br> <br><img vspace="5" hspace="5" src="multifactor_long_only_01.png" alt=""> <h2 id="4">2012&#33267;&#20170;&#25910;&#30410;&#29575;</h2> <h3><center>收益率统计</h3></center></html>
<html><table border="2" cellpadding="8" align="center" cellspacing="2">
<tr><td align="right"> </td><td align="right">年化收益率（%）</td><td align="right">最大回撤（%）</td><td align="right">波动率（%）</td><td align="right">夏普率  </td><td align="right">月度胜率（%）</td></tr>
<tr><td align="right">策略</td><td align="right">27.06</td><td align="right">55.36</td><td align="right">30.20</td><td align="right">0.91</td><td align="right">68.46</td></tr>
<tr><td align="right">沪深300</td><td align="right">7.41</td><td align="right">46.70</td><td align="right">22.83</td><td align="right">0.35</td><td align="right">52.29</td></tr>
</table></html>
<html> <h4><center>统计截至：2021-11-12</h4></center></html>
<html><br> <br> <br><h2 id="5">&#20998;&#24180;&#25910;&#30410;&#29575;</h2> <h3><center>策略分年收益率</h3></center></html>
<html><table border="2" cellpadding="8" align="center" cellspacing="2">
<tr><td align="right"> </td><td align="right">策略收益率（%）</td><td align="right">沪深300收益率（%）</td><td align="right">策略最大回撤（%）</td><td align="right">沪深300最大回撤（%）</td></tr>
<tr><td align="right">2012</td><td align="right">11.91</td><td align="right">3.87</td><td align="right">22.27</td><td align="right">22.41</td></tr>
<tr><td align="right">2013</td><td align="right">47.18</td><td align="right">-7.65</td><td align="right">16.51</td><td align="right">22.16</td></tr>
<tr><td align="right">2014</td><td align="right">53.00</td><td align="right">51.66</td><td align="right">13.60</td><td align="right">10.43</td></tr>
<tr><td align="right">2015</td><td align="right">119.45</td><td align="right">5.58</td><td align="right">55.36</td><td align="right">43.48</td></tr>
<tr><td align="right">2016</td><td align="right">-0.41</td><td align="right">-11.28</td><td align="right">34.77</td><td align="right">23.51</td></tr>
<tr><td align="right">2017</td><td align="right">-11.91</td><td align="right">21.78</td><td align="right">20.47</td><td align="right">6.07</td></tr>
<tr><td align="right">2018</td><td align="right">-17.60</td><td align="right">-25.31</td><td align="right">26.79</td><td align="right">31.88</td></tr>
<tr><td align="right">2019</td><td align="right">40.29</td><td align="right">36.07</td><td align="right">16.77</td><td align="right">13.49</td></tr>
<tr><td align="right">2020</td><td align="right">56.28</td><td align="right">27.21</td><td align="right">16.88</td><td align="right">16.08</td></tr>
<tr><td align="right">2021</td><td align="right">18.92</td><td align="right">-6.20</td><td align="right">21.66</td><td align="right">18.19</td></tr>
</table></html>
<html> <h4><center>统计截至：2021-11-12</h4></center></html>
<html><br> <br> <br><h2 id="6">&#20998;&#26376;&#25910;&#30410;&#29575;</h2><img vspace="5" hspace="5" src="multifactor_long_only_02.png" alt=""> <h2 id="7">&#26368;&#26032;&#25104;&#20221;&#32929;</h2> <h3><center>最新持仓权重</h3></center></html>
<html><table border="2" cellpadding="8" align="center" cellspacing="2">
<tr><td align="right">序号</td><td align="right">代码</td><td align="right">简称</td><td align="right">权重（%）</td><td align="right">买入日期</td><td align="right">持仓收益率（%）</td></tr>
<tr><td align="right">1</td><td align="right">603906</td><td align="right">龙蟠科技</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">1029.69</td></tr>
<tr><td align="right">2</td><td align="right">600010</td><td align="right">包钢股份</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">74.42</td></tr>
<tr><td align="right">3</td><td align="right">603650</td><td align="right">彤程新材</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">213.17</td></tr>
<tr><td align="right">4</td><td align="right">688518</td><td align="right">联赢激光</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">92.34</td></tr>
<tr><td align="right">5</td><td align="right">603098</td><td align="right">森特股份</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">545.93</td></tr>
<tr><td align="right">6</td><td align="right">600460</td><td align="right">士兰微</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">661.71</td></tr>
<tr><td align="right">7</td><td align="right">603290</td><td align="right">斯达半导</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">2496.52</td></tr>
<tr><td align="right">8</td><td align="right">600018</td><td align="right">上港集团</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-2.95</td></tr>
<tr><td align="right">9</td><td align="right">688981</td><td align="right">中芯国际</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-32.27</td></tr>
<tr><td align="right">10</td><td align="right">601009</td><td align="right">南京银行</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">51.11</td></tr>
<tr><td align="right">11</td><td align="right">600882</td><td align="right">妙可蓝多</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">590.60</td></tr>
<tr><td align="right">12</td><td align="right">601058</td><td align="right">赛轮轮胎</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">665.24</td></tr>
<tr><td align="right">13</td><td align="right">600859</td><td align="right">王府井</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">119.40</td></tr>
<tr><td align="right">14</td><td align="right">000001</td><td align="right">平安银行</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">75.91</td></tr>
<tr><td align="right">15</td><td align="right">601966</td><td align="right">玲珑轮胎</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">224.27</td></tr>
<tr><td align="right">16</td><td align="right">603737</td><td align="right">三棵树</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">960.60</td></tr>
<tr><td align="right">17</td><td align="right">600563</td><td align="right">法拉电子</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">592.15</td></tr>
<tr><td align="right">18</td><td align="right">688202</td><td align="right">美迪西</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">748.29</td></tr>
<tr><td align="right">19</td><td align="right">603707</td><td align="right">健友股份</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">378.46</td></tr>
<tr><td align="right">20</td><td align="right">688516</td><td align="right">奥特维</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">290.41</td></tr>
<tr><td align="right">21</td><td align="right">002326</td><td align="right">永太科技</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">1120.21</td></tr>
<tr><td align="right">22</td><td align="right">600499</td><td align="right">科达制造</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">385.36</td></tr>
<tr><td align="right">23</td><td align="right">603345</td><td align="right">安井食品</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">380.02</td></tr>
<tr><td align="right">24</td><td align="right">002142</td><td align="right">宁波银行</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">142.05</td></tr>
<tr><td align="right">25</td><td align="right">601778</td><td align="right">晶科科技</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">45.44</td></tr>
<tr><td align="right">26</td><td align="right">002027</td><td align="right">分众传媒</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">4.66</td></tr>
<tr><td align="right">27</td><td align="right">000661</td><td align="right">长春高新</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">196.99</td></tr>
<tr><td align="right">28</td><td align="right">688065</td><td align="right">凯赛生物</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-7.57</td></tr>
<tr><td align="right">29</td><td align="right">603260</td><td align="right">合盛硅业</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">401.00</td></tr>
<tr><td align="right">30</td><td align="right">601919</td><td align="right">中远海控</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">462.31</td></tr>
<tr><td align="right">31</td><td align="right">601828</td><td align="right">美凯龙</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-5.74</td></tr>
<tr><td align="right">32</td><td align="right">601633</td><td align="right">长城汽车</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">1001.43</td></tr>
<tr><td align="right">33</td><td align="right">300748</td><td align="right">金力永磁</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">166.18</td></tr>
<tr><td align="right">34</td><td align="right">600378</td><td align="right">昊华科技</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">319.23</td></tr>
<tr><td align="right">35</td><td align="right">600377</td><td align="right">宁沪高速</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">7.75</td></tr>
<tr><td align="right">36</td><td align="right">600845</td><td align="right">宝信软件</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">474.56</td></tr>
<tr><td align="right">37</td><td align="right">002601</td><td align="right">龙蟒佰利</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">142.58</td></tr>
<tr><td align="right">38</td><td align="right">600989</td><td align="right">宝丰能源</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-4.28</td></tr>
<tr><td align="right">39</td><td align="right">600641</td><td align="right">万业企业</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">460.73</td></tr>
<tr><td align="right">40</td><td align="right">600141</td><td align="right">兴发集团</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">322.53</td></tr>
<tr><td align="right">41</td><td align="right">600111</td><td align="right">北方稀土</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">423.49</td></tr>
<tr><td align="right">42</td><td align="right">002459</td><td align="right">晶澳科技</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">675.10</td></tr>
<tr><td align="right">43</td><td align="right">601800</td><td align="right">中国交建</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-35.46</td></tr>
<tr><td align="right">44</td><td align="right">600309</td><td align="right">万华化学</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">237.07</td></tr>
<tr><td align="right">45</td><td align="right">688033</td><td align="right">天宜上佳</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">-21.70</td></tr>
<tr><td align="right">46</td><td align="right">603179</td><td align="right">新泉股份</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">250.55</td></tr>
<tr><td align="right">47</td><td align="right">600352</td><td align="right">浙江龙盛</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">56.85</td></tr>
<tr><td align="right">48</td><td align="right">603881</td><td align="right">数据港</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">88.93</td></tr>
<tr><td align="right">49</td><td align="right">300568</td><td align="right">星源材质</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">515.35</td></tr>
<tr><td align="right">50</td><td align="right">002460</td><td align="right">赣锋锂业</td><td align="right">2.00</td><td align="right">2021-11-12</td><td align="right">588.50</td></tr>
</table></html>
<html> <h4><center>统计截至：2021-11-12</h4></center></html>
<html><br> <br> <br><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
function multifactor_long_only()
str='多因子树量化多头策略';
disp(['<html> <h1><center>',str,'</h1></center>' '</html>'])
%% 策略简介
output_dir='F:\matlab_projects\market_classification\hidden_3';
load(fullfile(output_dir,'long_only.mat'),'sptf','exp_dates','nav_s','idx','allstk','reg_dates','ws','temp_res');

str='策略依靠因子体系选取未来上涨潜力较大股票：';
disp(['<html>',str, '</html>'])
begin_ind=find(nav_s~=1,1,'first')-1;
begin_date=datestr(exp_dates(begin_ind),'yyyy-mm-dd');
end_date=datestr(exp_dates(end),'yyyy-mm-dd');
hs300=get_index_price('000300',begin_date,end_date);
nav=nav_s(begin_ind:end);
exp_dates=exp_dates(begin_ind:end);
num_t=numel(exp_dates);
baseline=hs300/hs300(1);
ane=compute_ane(nav,exp_dates);
mdd=max_retract(nav);
sp=sharpratio_daily(nav);
wr=compute_wr_cash(nav,0.03,255);
[~,reg_ind]=ismember(reg_dates,exp_dates);
num_rd=numel(reg_dates);
% [nav]=allpos2nav_simple(idx,reg_ind,w);
% baseline=allpos2nav_simple(idx,reg_ind,bw);
figure('Position',[500 500 2000,800]);
plot(exp_dates,log(nav));hold on;plot(exp_dates,log(baseline));grid on;grid minor;legend({'组合','沪深300'},'location','NorthWest');datetick;title(['年化收益率（%）: ' num2str(ane*100,'%3.1f')  '; 最大回撤（%）:' num2str(mdd*100,'%3.1f') '; 夏普率:' num2str(sp,'%0.2f')]);

str='<br> <br> <br>';
disp(['<html>',str,'</html>'])
%% 2012至今收益率
stats=cell(6,3);
stats(1,2:3)={'策略','沪深300'};
stats(2:6,1)={'年化收益率（%）','最大回撤（%）','波动率（%）','夏普率  ','月度胜率（%）'};
stats(2:6,2)=num2cell([ane*100 mdd*100 hist_vol(nav)*100 sp wr*100]);
stats(2:6,3)=num2cell([compute_ane(baseline,exp_dates)*100 max_retract(baseline)*100 hist_vol(baseline)*100 sharpratio_daily(baseline) compute_wr_cash(baseline,0.03,255)*100]);
% stats_str=compute_string_table(stats');
% makeHtmlTable(ones(size(stats_str)),stats_str);
showtable(stats','收益率统计',['统计截至：' datestr(exp_dates(end),'yyyy-mm-dd')])
%% 分年收益率
num_years=numel(unique(year(exp_dates)));
stats2=cell(1+num_years,5);
stats2(1,2:end)={'策略收益率（%）','沪深300收益率（%）','策略最大回撤（%）','沪深300最大回撤（%）'};
stats2(2:num_years+1,1)=cellfun(@num2str,num2cell([2012:2012+num_years-1]),'UniformOutput',false);
stats2(2:num_years+1,2)=num2cell(compute_annual_rtn(nav,exp_dates)*100);
stats2(2:num_years+1,3)=num2cell(compute_annual_rtn(baseline,exp_dates)*100);
stats2(2:num_years+1,4)=num2cell(compute_annual_mdd(nav,exp_dates)*100);
stats2(2:num_years+1,5)=num2cell(compute_annual_mdd(hs300,exp_dates)*100);
% stats_str2=compute_string_table(stats2);
% makeHtmlTable(ones(size(stats_str2)),stats_str2);
showtable(stats2,'策略分年收益率',['统计截至：' datestr(exp_dates(end),'yyyy-mm-dd')])
% str='<br> <br> <br>';
% disp(['<html>',str,'</html>'])
%% 分月收益率
[mly_rtn , ~]=compute_monthly_rtn(nav,exp_dates);
[baseline_rtn, mdates]=compute_monthly_rtn(hs300,exp_dates);
figure('Position',[500 500 2000,800]);
b=bar(datenum(mdates(end-11:end),'yyyymm'),[baseline_rtn(end-11:end)' mly_rtn(end-11:end)' ]*100,'grouped');datetick;
legend({'沪深300','策略'});
ylabel('Monthly Return (%)');
xlabel('Last 12 Months');
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center','VerticalAlignment','bottom','FontSize',14)
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center','VerticalAlignment','bottom','FontSize',14)
grid on;grid minor;
% str='<br> <br> <br>';
% disp(['<html>',str,'</html>'])
%% 最新成份股
stock_list=allstk(sptf{end-1});
num_h=numel(stock_list);
latest_holding=cell(num_h+1,6);
latest_holding(1,1:6)={'序号','代码','简称','权重（%）','买入日期','持仓收益率（%）'};
latest_holding(2:end,1)=cellfun(@num2str,num2cell([1:num_h]),'UniformOutput',false);
latest_holding(2:end,2:3)=get_stock_name(stock_list);
latest_holding(2:end,4)=num2cell(1/num_h*100);
begin_dates=cell(num_h,1);
buy_rtn=cell(num_h,1);
[~,stk_ind]=ismember(stock_list,allstk);
for ih=1:num_h
    if stk_ind(ih)>0
        buy_ind=find(ws(stk_ind(ih),:)<0.0001,1,'last');
        begin_dates{ih}=datestr(reg_dates(buy_ind),'yyyy-mm-dd');
        buy_rtn{ih}=(idx{stk_ind(ih)}.prc(end)/idx{stk_ind(ih)}.prc(reg_ind(buy_ind))-1)*100;
    end
end 
latest_holding(2:end,5)=begin_dates;
latest_holding(2:end,6)=buy_rtn;
% latest_str=compute_string_table(latest_holding);
% str='title';
% disp(['<html> <h3><center>',str,'</h3></center>' '</html>'])
% makeHtmlTable(ones(size(latest_str)),latest_str);
showtable(latest_holding,'最新持仓权重',['统计截至：' datestr(reg_dates(end),'yyyy-mm-dd')])
%%
nav_record=cell(num_t,2);
nav_record(:,1)=coldatestr(exp_dates);
nav_record(:,2)=num2cell(nav);
xlswrite(fullfile(output_dir,[end_date 'nav_record.xlsx']),nav_record);
%%
file_name=[end_date '_record.xlsx'];
print_results=1;
if print_results==1
    record=cell(num_rd,5);
    record(1,:)={'区间开始','区间结束','代码','名称','收益率'};
    it=2;
    for ir=1:num_rd
        if numel(stock_list)==0
            record(it,1)={datestr(exp_dates(min(num_t,reg_ind(ir)+1)),'yyyymmdd')};
            record(it,2)={datestr(reg_dates(min(num_rd,ir+1)),'yyyymmdd')};
            %         it=it+1;
        else
            record(it:it+numel(allstk(sptf{ir}))-1,1)={datestr(exp_dates(min(num_t,reg_ind(ir)+1)),'yyyymmdd')};
            record(it:it+numel(allstk(sptf{ir}))-1,2)={datestr(reg_dates(min(num_rd,ir+1)),'yyyymmdd')};
            %             record(it:it+numel(ptf{ir})-1,3:4)=get_stock_name(ptf{ir});
            it=it+numel(allstk(sptf{ir}));
        end
    end
    xlswrite(fullfile(output_dir,file_name),record);
    xlswrite(fullfile(output_dir,[end_date 'stats.xlsx']),stats);
    %     xlswrite(fullfile(output_dir,'major.xlsx'),major);
end
warning('on');
end
##### SOURCE END #####
--></body></html>