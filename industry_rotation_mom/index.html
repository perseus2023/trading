
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>publish_industry_rotation_mom</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2023-07-22"><meta name="DC.source" content="publish_industry_rotation_mom.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0 auto;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin-left:300px; margin-right:300px; margin-top:50px; font-family:Arial, Helvetica, sans-serif; font-size:14px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:right; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }
h4 { padding:0px; margin:0px 0px 5px; font-family:sans-serif; font-size:0.8em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th {padding:7px 20px; text-align:right; vertical-align:middle; border: 2px solid #d6d4d4; font-weight:bold; align:middle; }
table td {padding:7px 20px; text-align:right; vertical-align:top; border:2px solid #d6d4d4; margin-left:auto;align:middle; }





  </style></head><body><div class="content"><h2>Contents</h2><div><ul><li><a href="#3">2012&#33267;&#20170;&#25910;&#30410;&#29575;</a></li><li><a href="#4">&#20998;&#24180;&#25910;&#30410;&#29575;</a></li><li><a href="#5">&#20998;&#26376;&#25910;&#30410;&#29575;</a></li><li><a href="#6">&#26368;&#26032;&#25104;&#20221;&#32929;</a></li></ul></div> <h1><center>动量行业轮动策略</h1></center></html>
<html><br> <br> <br></html>
<html>策略持有具有动量效应的行业，每月月初月中各换仓一次，对标基准为中证全指收益率。</html>
<html><br> <br> <br><img vspace="5" hspace="5" src="publish_industry_rotation_mom_01.png" alt=""> <h2 id="3">2012&#33267;&#20170;&#25910;&#30410;&#29575;</h2> <h3><center>收益率统计</h3></center></html>
<html><table border="2" cellpadding="8" align="center" cellspacing="2">
<tr><td align="right"> </td><td align="right">年化收益率（%）</td><td align="right">最大回撤（%）</td><td align="right">波动率（%）</td><td align="right">夏普率</td></tr>
<tr><td align="right">策略</td><td align="right">18.43</td><td align="right">52.48</td><td align="right">27.10</td><td align="right">0.78</td></tr>
<tr><td align="right">中证全指</td><td align="right">5.53</td><td align="right">57.85</td><td align="right">22.84</td><td align="right">0.36</td></tr>
<tr><td align="right">策略对冲中证全指</td><td align="right">12.81</td><td align="right">12.66</td><td align="right">10.16</td><td align="right">1.28</td></tr>
</table></html>
<html> <h4><center>统计截至：2023-07-21</h4></center></html>
<html><br> <br> <br><h2 id="4">&#20998;&#24180;&#25910;&#30410;&#29575;</h2> <h3><center>策略分年收益率</h3></center></html>
<html><table border="2" cellpadding="8" align="center" cellspacing="2">
<tr><td align="right"> </td><td align="right">策略收益率（%）</td><td align="right">中证全指收益率（%）</td><td align="right">超额收益率（%）</td></tr>
<tr><td align="right">2012</td><td align="right">-0.48</td><td align="right">6.92</td><td align="right">-7.39</td></tr>
<tr><td align="right">2013</td><td align="right">8.50</td><td align="right">5.21</td><td align="right">3.28</td></tr>
<tr><td align="right">2014</td><td align="right">69.04</td><td align="right">45.82</td><td align="right">23.21</td></tr>
<tr><td align="right">2015</td><td align="right">72.45</td><td align="right">32.56</td><td align="right">39.89</td></tr>
<tr><td align="right">2016</td><td align="right">-12.39</td><td align="right">-14.41</td><td align="right">2.02</td></tr>
<tr><td align="right">2017</td><td align="right">10.77</td><td align="right">2.34</td><td align="right">8.43</td></tr>
<tr><td align="right">2018</td><td align="right">-19.81</td><td align="right">-29.94</td><td align="right">10.12</td></tr>
<tr><td align="right">2019</td><td align="right">31.59</td><td align="right">31.11</td><td align="right">0.48</td></tr>
<tr><td align="right">2020</td><td align="right">41.61</td><td align="right">24.92</td><td align="right">16.68</td></tr>
<tr><td align="right">2021</td><td align="right">39.73</td><td align="right">6.19</td><td align="right">33.53</td></tr>
<tr><td align="right">2022</td><td align="right">1.89</td><td align="right">-20.32</td><td align="right">22.21</td></tr>
<tr><td align="right">2023</td><td align="right">8.53</td><td align="right">0.73</td><td align="right">7.80</td></tr>
</table></html>
<html> <h4><center>统计截至：2023-07-21</h4></center></html>
<html><br> <br> <br><h2 id="5">&#20998;&#26376;&#25910;&#30410;&#29575;</h2><img vspace="5" hspace="5" src="publish_industry_rotation_mom_02.png" alt=""> <h2 id="6">&#26368;&#26032;&#25104;&#20221;&#32929;</h2> <h3><center>近期持仓行业</h3></center></html>
<html><table border="2" cellpadding="8" align="center" cellspacing="2">
<tr><td align="right">买入日期</td><td align="right">行业1</td><td align="right">2</td><td align="right">3</td><td align="right">4</td><td align="right">5</td><td align="right">基准收益率</td><td align="right">行业收益率</td><td align="right">超额收益率</td></tr>
<tr><td align="right">20230201</td><td align="right">交通运输</td><td align="right">家电</td><td align="right">食品饮料</td><td align="right">电新</td><td align="right">国防军工</td><td align="right">0.10</td><td align="right">-0.46</td><td align="right">-0.56</td></tr>
<tr><td align="right">20230215</td><td align="right">电子</td><td align="right">通信</td><td align="right">食品饮料</td><td align="right">纺织服装</td><td align="right">传媒</td><td align="right">-0.21</td><td align="right">0.88</td><td align="right">1.09</td></tr>
<tr><td align="right">20230301</td><td align="right">通信</td><td align="right">纺织服装</td><td align="right">传媒</td><td align="right">农林牧渔</td><td align="right">非银行金融</td><td align="right">-3.14</td><td align="right">-2.11</td><td align="right">1.03</td></tr>
<tr><td align="right">20230315</td><td align="right">计算机</td><td align="right">传媒</td><td align="right">通信</td><td align="right">交通运输</td><td align="right">电子</td><td align="right">2.43</td><td align="right">11.29</td><td align="right">8.86</td></tr>
<tr><td align="right">20230403</td><td align="right">计算机</td><td align="right">传媒</td><td align="right">电子</td><td align="right">综合</td><td align="right">通信</td><td align="right">0.77</td><td align="right">-1.23</td><td align="right">-2.00</td></tr>
<tr><td align="right">20230417</td><td align="right">传媒</td><td align="right">通信</td><td align="right">电子</td><td align="right">非银行金融</td><td align="right">综合</td><td align="right">-3.05</td><td align="right">-0.24</td><td align="right">2.81</td></tr>
<tr><td align="right">20230504</td><td align="right">传媒</td><td align="right">非银行金融</td><td align="right">商贸零售</td><td align="right">家电</td><td align="right">电新</td><td align="right">-1.24</td><td align="right">-2.11</td><td align="right">-0.87</td></tr>
<tr><td align="right">20230515</td><td align="right">综合</td><td align="right">纺织服装</td><td align="right">非银行金融</td><td align="right">房地产</td><td align="right">商贸零售</td><td align="right">-2.49</td><td align="right">-5.17</td><td align="right">-2.68</td></tr>
<tr><td align="right">20230601</td><td align="right">传媒</td><td align="right">通信</td><td align="right">计算机</td><td align="right">综合</td><td align="right">家电</td><td align="right">2.00</td><td align="right">5.60</td><td align="right">3.59</td></tr>
<tr><td align="right">20230615</td><td align="right">电子</td><td align="right">计算机</td><td align="right">食品饮料</td><td align="right">交通运输</td><td align="right">商贸零售</td><td align="right">-0.43</td><td align="right">-2.09</td><td align="right">-1.66</td></tr>
<tr><td align="right">20230703</td><td align="right">医药</td><td align="right">电子</td><td align="right">国防军工</td><td align="right">综合</td><td align="right">机械</td><td align="right">-0.77</td><td align="right">-1.31</td><td align="right">-0.54</td></tr>
<tr><td align="right">20230717</td><td align="right">电子</td><td align="right">交通运输</td><td align="right">农林牧渔</td><td align="right">综合</td><td align="right">银行</td><td align="right">-1.47</td><td align="right">-0.56</td><td align="right">0.91</td></tr>
</table></html>
<html> <h4><center>统计截至：2023-07-21</h4></center></html>
<html><br> <br> <br><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####
function publish_industry_rotation_mom()

str='动量行业轮动策略';
disp(['<html> <h1><center>',str,'</h1></center>' '</html>'])
insert_break;
str='策略持有具有动量效应的行业，每月月初月中各换仓一次，对标基准为中证全指收益率。';
disp(['<html>',str, '</html>'])
% str='PE区间判定';
% disp(['<html>',str, '</html>'])
input_dir='W:\industry_rotation_mom';
warning('off')
% load(fullfile(input_dir,'res'),'res');
res=load(fullfile(input_dir,'res.mat'),'ptf_acc','stats_data','nav_data','monthly_data','zzqz','res_data','ptf_data','rtn_data');
% begin_date='2012-01-01';
% exp_dates=res.exp_dates;
exp_dates=datenum(res.nav_data(2:end,1));
% end_date=datestr(exp_dates(end),'yyyy-mm-dd');
% begin_ind=find(exp_dates>=datenum(begin_date),1,'first');
% exp_dates=exp_dates(begin_ind:end);
% hs300=get_index_price('000300',begin_date,end_date);
% hs300=res.zzqz;
nav=cell2vect(res.nav_data(2:end,2));
hs300=cell2vect(res.nav_data(2:end,3));
% nav=res.stock_nav(begin_ind:end);
baseline=hs300/hs300(1);
ane=compute_ane(nav,exp_dates);
sp=sharpratio_daily(nav);
mdd=max_retract(nav);
hedge_nav=cell2vect(res.nav_data(2:end,4));
wr=compute_wr_cash(hedge_nav,0,255);

% [nav]=allpos2nav_simple(idx,reg_ind,w);
% baseline=allpos2nav_simple(idx,reg_ind,bw);
figure('Position',[500 500 2000,800]);
plot(exp_dates,log(nav));hold on;plot(exp_dates,log(baseline));plot(exp_dates,log(hedge_nav));grid on;grid minor;legend({'组合净值曲线(log)','中证全指(log)','组合对冲中证全指(log)'},'location','NorthWest');datetick;title(['年化收益率（%）: ' num2str(ane*100,'%3.1f')  '; 最大回撤（%）:' num2str(mdd*100,'%3.1f') '; 夏普率:' num2str(sp,'%0.2f')]);

str='<br> <br> <br>';
disp(['<html>',str,'</html>'])
%% 2012至今收益率
stats=cell(5,4);
stats(1,2:4)={'策略','中证全指','策略对冲中证全指'};
stats(2:5,1)={'年化收益率（%）','最大回撤（%）','波动率（%）','夏普率'};
stats(2:5,2)=num2cell([ane*100 mdd*100 hist_vol(nav)*100 sp]);
stats(2:5,3)=num2cell([compute_ane(baseline,exp_dates)*100 max_retract(baseline)*100 hist_vol(baseline)*100 sharpratio_daily(baseline)]);
stats(2:5,4)=num2cell([compute_ane(hedge_nav,exp_dates)*100 max_retract(hedge_nav)*100 hist_vol(hedge_nav)*100 sharpratio_daily(hedge_nav)]);
% stats_str=compute_string_table(stats');
% makeHtmlTable(ones(size(stats_str)),stats_str);
showtable(stats','收益率统计',['统计截至：' datestr(exp_dates(end),'yyyy-mm-dd')])
%% 分年收益率
num_years=numel(unique(year(exp_dates)));
stats2=cell(1+num_years,4);
stats2(1,2:end)={'策略收益率（%）','中证全指收益率（%）','超额收益率（%）'};
stats2(2:num_years+1,1)=cellfun(@num2str,num2cell([2012:2012+num_years-1]),'UniformOutput',false);
stats2(2:num_years+1,2)=num2cell(compute_annual_rtn(nav,exp_dates)*100);
stats2(2:num_years+1,3)=num2cell(compute_annual_rtn(baseline,exp_dates)*100);
stats2(2:num_years+1,4)=num2cell(compute_annual_rtn(nav,exp_dates)*100-compute_annual_rtn(baseline,exp_dates)*100);

% stats_str2=compute_string_table(stats2);
% makeHtmlTable(ones(size(stats_str2)),stats_str2);
showtable(stats2,'策略分年收益率',['统计截至：' datestr(exp_dates(end),'yyyy-mm-dd')])
% str='<br> <br> <br>';
% disp(['<html>',str,'</html>'])
%% 分月收益率
[mly_rtn , ~]=compute_monthly_rtn(nav,exp_dates);
[baseline_rtn, mdates]=compute_monthly_rtn(hs300,exp_dates);
figure('Position',[500 500 2000,800]);
b=bar(datenum(mdates(end-11:end),'yyyymm'),[baseline_rtn(end-11:end)' mly_rtn(end-11:end)' ]*100,'grouped');datetick;
legend({'中证全指','策略'});
ylabel('Monthly Return (%)');
xlabel('Last 12 Months');
xtips1 = b(1).XEndPoints;
ytips1 = b(1).YEndPoints;
labels1 = string(round(b(1).YData,2));
text(xtips1,ytips1,labels1,'HorizontalAlignment','center','VerticalAlignment','bottom','FontSize',14)
xtips2 = b(2).XEndPoints;
ytips2 = b(2).YEndPoints;
labels2 = string(round(b(2).YData,2));
text(xtips2,ytips2,labels2,'HorizontalAlignment','center','VerticalAlignment','bottom','FontSize',14)
grid on;grid minor;
% str='<br> <br> <br>';
% disp(['<html>',str,'</html>'])
%% 最新成份股
all_periods=[res.rtn_data(:,1) res.ptf_data res.rtn_data(:,2:4)];
last_periods=all_periods(end-11:end,:);
header={'买入日期','行业1','2','3','4','5','基准收益率','行业收益率','超额收益率'};
last_periods=[header;last_periods];
showtable(last_periods,'近期持仓行业',['统计截至：' datestr(exp_dates(end),'yyyy-mm-dd')])

% pos=res.pos;
% cur_holding=res.allstk(find(pos(:,end)>0));
% num_h=numel(cur_holding);

% latest_holding=cell(num_h+1,6);
% latest_holding(1,1:6)={'序号','代码','简称','权重（%）','买入日期','持仓收益率（%）'};
% % latest_holding(2:end,1)=cellfun(@num2str,num2cell([1:num_h]),'UniformOutput',false);
% latest_holding(2:end,2:3)=get_stock_name(cur_holding);
% num_holding=numel(cur_holding);
% if num_holding>30
%     total_pos=sum(pos(:,end))/num_holding*100;
%     latest_holding(2:end,4)=num2cell(pos(pos(:,end)>0,end)/num_holding*100);
% else
%     total_pos=sum(pos(:,end))/30*100;
%     latest_holding(2:end,4)=num2cell(pos(pos(:,end)>0,end)/30*100);
% end
% begin_dates=cell(num_h,1);
% buy_rtn=cell(num_h,1);
% allstk=res.allstk;
% [~,stk_ind]=ismember(cur_holding,allstk);
% idx=res.idx;
% for ih=1:num_h
%     if stk_ind(ih)>0
%         buy_ind=find(pos(stk_ind(ih),1:end-1)<0.0001,1,'last');
%         try
%         begin_dates{ih}=datestr(res.exp_dates(buy_ind),'yyyy-mm-dd');
%         catch me
%             disp(me)
%         end
%             
%         buy_rtn{ih}=(idx{stk_ind(ih)}.prc(end)/idx{stk_ind(ih)}.prc(buy_ind)-1)*100;
%     end
% end
% latest_holding(2:end,5)=begin_dates;
% latest_holding(2:end,6)=buy_rtn;
% % latest_str=compute_string_table(latest_holding);
% % str='title';
% % disp(['<html> <h3><center>',str,'</h3></center>' '</html>'])
% % makeHtmlTable(ones(size(latest_str)),latest_str);
% 
% latest_holding(2:end,:)=sortrows(latest_holding(2:end,:),4,'descend');
% latest_holding(2:end,1)=cellfun(@num2str,num2cell([1:num_h]),'UniformOutput',false);
% showtable(latest_holding,['最新持仓权重，总仓位' num2str(total_pos,'%0.2f')],['统计截至：' datestr(exp_dates(end),'yyyy-mm-dd')])
% citic_info=get_stock_citic(latest_holding(2:end,2));
% stock_name=get_stock_name(latest_holding(2:end,2));
% for is=1:numel(cur_holding)
%     %     img_file=['W:\pb_bands\all\' stock_codes{is} '.png'];
%     img_file=['https://www.deeperquant.com:8888//value_trading_hs300/optimized/' stock_name{is,1} ' ' stock_name{is,2} '.png'];
%     if exist(img_file,'file')||1
%         insert_title([citic_info{is,1} '  ' citic_info{is,2} '  '   citic_info{is,4}]);
%         insert_image(img_file,3125,2850);
%         insert_break;
%     end
% end
end
##### SOURCE END #####
--></body></html>